{% extends "base.html" %}
{% block title %}Herinneringen{% endblock %}
{% block content %}
<div class="page-header">
    <h2><i class="bi bi-bell"></i> Vervallen facturen - Herinneringen</h2>
    <a href="{{ url_for('verkoopfacturen.lijst') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Terug
    </a>
</div>

{% if facturen %}
<div class="alert alert-danger">
    <i class="bi bi-exclamation-triangle"></i>
    Er zijn <strong>{{ facturen|length }}</strong> vervallen facturen die aandacht vereisen.
</div>
{% endif %}

<div class="card">
    <div class="card-body p-0">
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th>Factuurnummer</th>
                    <th>Klant</th>
                    <th>Vervaldatum</th>
                    <th>Dagen vervallen</th>
                    <th class="text-end">Openstaand</th>
                    <th class="text-end">Acties</th>
                </tr>
            </thead>
            <tbody>
                {% for f in facturen %}
                {% set dagen = (f.vervaldatum.__class__.today() - f.vervaldatum).days %}
                <tr>
                    <td>
                        <a href="{{ url_for('verkoopfacturen.detail', id=f.id) }}">{{ f.factuurnummer }}</a>
                    </td>
                    <td>{{ f.klant.naam }}<br><small class="text-muted">{{ f.klant.email or '' }}</small></td>
                    <td>{{ f.vervaldatum|datum }}</td>
                    <td>
                        <span class="badge {% if dagen > 30 %}bg-danger{% elif dagen > 14 %}bg-warning{% else %}bg-info{% endif %}">
                            {{ dagen }} dagen
                        </span>
                    </td>
                    <td class="text-end text-danger fw-bold">{{ f.openstaand_bedrag|euro }}</td>
                    <td class="text-end">
                        <a href="{{ url_for('betalingen.nieuw', factuur_type='verkoop', factuur_id=f.id) }}" class="btn btn-sm btn-success">
                            <i class="bi bi-credit-card"></i> Betaling
                        </a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="text-center text-muted py-4">
                        Geen vervallen facturen. Alles is up-to-date!
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
